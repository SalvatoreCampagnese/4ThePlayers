{"version":3,"sources":["./src/app/users/users-routing.module.ts","./src/app/users/users.page.scss","./src/app/users/users.page.html","./src/app/users/users.page.ts","./src/app/users/users.module.ts"],"names":[],"mappings":"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","file":"users-users-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { UsersPage } from './users.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: UsersPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class UsersPageRoutingModule {}\r\n","export default \"ion-row {\\n  border-bottom: 1px solid rgba(255, 255, 255, 0.5);\\n}\\nion-row ion-col {\\n  display: flex;\\n  align-items: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdXNlcnMvdXNlcnMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksaURBQUE7QUFDSjtBQUNJO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0FBQ1IiLCJmaWxlIjoic3JjL2FwcC91c2Vycy91c2Vycy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJpb24tcm93e1xyXG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC41KTtcclxuXHJcbiAgICBpb24tY29se1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIH1cclxufSJdfQ== */\";","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Utenti</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content style=\\\"--padding: 5px !important\\\" [fullscreen]=\\\"true\\\">\\r\\n  <ion-item color=\\\"white\\\">\\r\\n    <ion-label><i class=\\\"fas fa-search\\\"></i></ion-label>\\r\\n    <ion-input placeholder=\\\"Ricerca...\\\" [(ngModel)]=\\\"userSearch\\\"></ion-input>\\r\\n    <ion-button (click)=\\\"searchUser()\\\">Ricerca</ion-button>\\r\\n  </ion-item>\\r\\n  <br />\\r\\n  <ion-text>\\r\\n    <h2>Lista utenti</h2>\\r\\n  </ion-text>\\r\\n  <ion-grid style=\\\"padding: 5px\\\">\\r\\n    <ion-text *ngIf=\\\"usersFoundCounter == 0 && !userSearch\\\"\\r\\n      >Effettua una ricerca...</ion-text\\r\\n    >\\r\\n    <ion-text *ngIf=\\\"usersFoundCounter == 0 && userSearch\\\"\\r\\n      >Nessun utente trovato...</ion-text\\r\\n    >\\r\\n    <ion-row *ngFor=\\\"let user of usersList\\\">\\r\\n      <ion-col size=\\\"10\\\">{{user.username}}</ion-col>\\r\\n      <ion-col *ngIf=\\\"showButtonInvite\\\" size=\\\"2\\\">\\r\\n        <ion-button\\r\\n          disabled=\\\"{{user.disabled}}\\\"\\r\\n          (click)=\\\"onInviteUser(user._id)\\\"\\r\\n          ><i class=\\\"fas fa-plus\\\"></i\\r\\n        ></ion-button>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-content>\\r\\n\";","import { HttpClient, HttpHeaders, HttpParams } from \"@angular/common/http\";\r\nimport { Component, OnInit } from \"@angular/core\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport { Plugins } from \"@capacitor/core\";\r\nimport { GlobalEnv } from \"../env\";\r\nconst { Storage } = Plugins;\r\nimport { AuthService } from \"src/app/services/auth.service\";\r\nimport { Router } from \"@angular/router\";\r\n\r\n@Component({\r\n  selector: \"app-users\",\r\n  templateUrl: \"./users.page.html\",\r\n  styleUrls: [\"./users.page.scss\"],\r\n})\r\nexport class UsersPage implements OnInit {\r\n  constructor(\r\n    private activatedRoute: ActivatedRoute,\r\n    private env: GlobalEnv,\r\n    private http: HttpClient,\r\n    private authService: AuthService,\r\n    private router: Router\r\n  ) { }\r\n  userSearch: string = null;\r\n  teamId: any;\r\n  teamObj: any;\r\n  token: string;\r\n  usersList: any = [];\r\n  usersFoundCounter: number = 0;\r\n  tournamentId: any;\r\n  showButtonInvite: boolean = true;\r\n  searchValue: string = null;\r\n\r\n  ngOnInit() {\r\n    this.activatedRoute.queryParams.subscribe((params) => {\r\n      const teamId = params[\"teamId\"];\r\n      const tournamentId = params[\"tournamentId\"];\r\n      if (!teamId || !tournamentId) {\r\n        this.showButtonInvite = false;\r\n      } else {\r\n        this.teamId = teamId;\r\n\r\n        this.tournamentId = tournamentId;\r\n      }\r\n      this.authService.getToken().then(() => {\r\n        if (this.authService.isLoggedIn) {\r\n          Storage.get({ key: \"token\" }).then((data) => {\r\n            this.token = data.value;\r\n          });\r\n        } else {\r\n          this.router.navigateByUrl(\"/login\");\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  onInviteUser(idUser) {\r\n    this.env.isLoading = true;\r\n    const dataToPost = {\r\n      userId: idUser,\r\n    };\r\n    // Se ho tutti i dati a disposizione continuo con gli inviti\r\n    if (idUser && this.teamId) {\r\n      // Completo l'invito\r\n      this.http\r\n        .post(\r\n          this.env.baseUri +\r\n          `/tournaments/${this.tournamentId}/teams/${this.teamId}/invites`,\r\n          dataToPost\r\n        )\r\n        .subscribe(\r\n          (resp) => {\r\n            this.env.isLoading = false;\r\n            window.alert(\"Invitato correttamente\");\r\n            location.reload();\r\n          },\r\n          (error) => {\r\n            this.env.isLoading = false;\r\n            window.alert(error.error.errors[0].msg);\r\n            location.reload();\r\n          }\r\n        );\r\n    } else {\r\n      return;\r\n    }\r\n  }\r\n\r\n  searchUser() {\r\n    //\r\n    if (this.userSearch) {\r\n      this.http\r\n        .get(`${this.env.baseUri}/users?username=${this.userSearch}`)\r\n        .subscribe((response) => {\r\n          this.usersList = response;\r\n          this.usersList.sort(function (a, b) {\r\n            return a.username.replace(\" \", \"\") > b.username.replace(\" \", \"\")\r\n              ? 1\r\n              : -1;\r\n          });\r\n          if (this.teamId) {\r\n            this.http\r\n              .get(\r\n                this.env.baseUri +\r\n                `/tournaments/${this.tournamentId}/teams/${this.teamId}`\r\n              )\r\n              .subscribe((resp) => {\r\n                this.teamObj = resp;\r\n                this.updateList();\r\n                this.usersFoundCounter = Object.keys(this.usersList).length;\r\n              });\r\n          }\r\n        });\r\n    } else {\r\n      this.usersFoundCounter = 0;\r\n      this.usersList = [];\r\n    }\r\n  }\r\n  updateList() {\r\n    if (this.usersList && this.teamObj) {\r\n      for (var i = 0; i < this.teamObj.members.length; i++) {\r\n        for (var j = 0; j < this.usersList.length; j++) {\r\n          this.usersList[j].disabled = this.usersList[j].disabled\r\n            ? true\r\n            : false;\r\n          if (this.teamObj.members[i].userId === this.usersList[j]._id) {\r\n            this.usersList[j].disabled = true;\r\n          }\r\n        }\r\n      }\r\n      for (var i = 0; i < this.teamObj.invites.length; i++) {\r\n        for (var j = 0; j < this.usersList.length; j++) {\r\n          this.usersList[j].disabled = this.usersList[j].disabled\r\n            ? true\r\n            : false;\r\n          if (this.teamObj.invites[i].userId === this.usersList[j]._id) {\r\n            this.usersList[j].disabled = true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { UsersPageRoutingModule } from './users-routing.module';\r\n\r\nimport { UsersPage } from './users.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    UsersPageRoutingModule\r\n  ],\r\n  declarations: [UsersPage]\r\n})\r\nexport class UsersPageModule {}\r\n"],"sourceRoot":"webpack:///"}