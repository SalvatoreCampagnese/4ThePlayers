{"version":3,"sources":["./src/app/invites/invites-routing.module.ts","./src/app/invites/invites.module.ts","./src/app/invites/invites.page.scss","./src/app/invites/invites.page.html","./src/app/invites/invites.page.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACc;AAEV;AAE7C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,yDAAW;KACvB;CACF,CAAC;IAMW,wBAAwB,SAAxB,wBAAwB;CAAG;AAA3B,wBAAwB;IAJpC,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,wBAAwB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;AChBI;AACM;AACF;AAEA;AAEuB;AAEvB;IAWhC,iBAAiB,SAAjB,iBAAiB;CAAG;AAApB,iBAAiB;IAT7B,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,gFAAwB;SACzB;QACD,YAAY,EAAE,CAAC,yDAAW,CAAC;KAC5B,CAAC;GACW,iBAAiB,CAAG;AAAH;;;;;;;;;;;;;ACnB9B;AAAe,iFAAkB,kBAAkB,4BAA4B,wBAAwB,2BAA2B,GAAG,uCAAuC,kBAAkB,4BAA4B,GAAG,6CAA6C,+mBAA+mB,E;;;;;;;;;;;;ACAz3B;AAAe,+TAAgQ,wDAAwD,wKAAwK,0iBAA0iB,iBAAiB,0wBAA0wB,iBAAiB,6XAA6X,E;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAhpE;AACf;AACO;AAC1C,MAAM,EAAE,OAAO,EAAE,GAAG,uDAAO,CAAC;AACO;AACM;AACsB;AACH;IAO/C,WAAW,SAAX,WAAW;IAGtB,YACS,GAAc,EACb,MAAc,EACd,IAAgB,EAChB,WAAwB;QAHzB,QAAG,GAAH,GAAG,CAAW;QACb,WAAM,GAAN,MAAM,CAAQ;QACd,SAAI,GAAJ,IAAI,CAAY;QAChB,gBAAW,GAAX,WAAW,CAAa;QANlC,uBAAkB,GAAQ,EAAE,CAAC;QAC7B,wBAAmB,GAAQ,EAAE,CAAC;IAM3B,CAAC;IAEE,QAAQ;;YACZ,MAAM,KAAK,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,OAAO,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;gBAC9D,IAAI,IAAI,CAAC,KAAK,EAAE;oBACd,OAAO,IAAI,CAAC,KAAK,CAAC;iBACnB;YACH,CAAC,CAAC,CAAC;YACH,MAAM,YAAY,GAAG,0DAAS,CAAC,KAAK,CAAC,CAAC;YACtC,MAAM,MAAM,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;YAClC,IAAI,MAAM,EAAE;gBACV,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;aACzB;QACH,CAAC;KAAA;IAED,UAAU,CAAC,MAAM;QACf,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,UAAU,MAAM,EAAE,CAAC,CAAC,SAAS,CAC5D,CAAC,IAAI,EAAE,EAAE;YACP,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE;gBAC/D,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACzC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;gBACzB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBAC3C,MAAM,YAAY,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,YAAY,EAC9C,MAAM,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;oBACjC,IAAI,CAAC,IAAI;yBACN,GAAG,CACF,IAAI,CAAC,GAAG,CAAC,OAAO;wBACd,gBAAgB,YAAY,UAAU,MAAM,EAAE,CACjD;yBACA,SAAS,CACR,CAAC,IAAI,EAAE,EAAE;wBACP,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;wBACvC,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,SAAS,EAAE;4BACvC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;yBAC9C;6BAAM;4BACL,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;yBAC/C;oBACH,CAAC,EACD,CAAC,KAAK,EAAE,EAAE;wBACR,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,SAAS,EAAE;4BACvC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;yBAC9C;6BAAM;4BACL,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;yBAC/C;oBACH,CAAC,CACF,CAAC;iBACL;aACF;QACH,CAAC,EACD,CAAC,KAAK,EAAE,EAAE;YACR,QAAQ;QACV,CAAC,CACF,CAAC;IACJ,CAAC;IAEK,kBAAkB,CAAC,SAAS,EAAE,MAAM;;YACxC,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC;YAC1B,MAAM,KAAK,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,OAAO,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;gBAC9D,IAAI,IAAI,CAAC,KAAK,EAAE;oBACd,OAAO,IAAI,CAAC,KAAK,CAAC;iBACnB;YACH,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,IAAI;iBACN,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,YAAY,SAAS,CAAC,GAAG,EAAE,EAAE;gBACrD,SAAS,EAAE,MAAM;aAClB,CAAC;iBACD,SAAS,CACR,CAAC,IAAI,EAAE,EAAE;gBACP,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,KAAK,CAAC;gBAC3B,QAAQ,CAAC,MAAM,EAAE,CAAC;YACpB,CAAC,EACD,CAAC,KAAK,EAAE,EAAE;gBACR,MAAM,CAAC,KAAK,CAAC,iCAAiC,CAAC,CAAC;YAClD,CAAC,CACF,CAAC;QACN,CAAC;KAAA;IAED,SAAS,CAAC,KAAK;QACb,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACpC,IAAI,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE;gBAC/B,OAAO,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,OAAO,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;oBAC1C,MAAM,YAAY,GAAG,0DAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;oBAC3C,MAAM,MAAM,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;oBAClC,IAAI,MAAM,EAAE;wBACV,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;qBACzB;oBACD,KAAK,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;gBAC1B,CAAC,CAAC,CAAC;aACJ;iBAAM;gBACL,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;aACrC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;CACF;;YAlHQ,8CAAS;YAIT,sDAAM;YACN,+DAAU;YACV,yEAAW;;AAOP,WAAW;IALvB,+DAAS,CAAC;QACT,QAAQ,EAAE,aAAa;QACvB,+EAAkC;;KAEnC,CAAC;GACW,WAAW,CAqGvB;AArGuB","file":"invites-invites-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { InvitesPage } from './invites.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: InvitesPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class InvitesPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { InvitesPageRoutingModule } from './invites-routing.module';\n\nimport { InvitesPage } from './invites.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    InvitesPageRoutingModule\n  ],\n  declarations: [InvitesPage]\n})\nexport class InvitesPageModule {}\n","export default \".team-container {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  flex-direction: column;\\n}\\n.team-container .flex-direction-row {\\n  display: flex;\\n  justify-content: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaW52aXRlcy9pbnZpdGVzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGFBQUE7RUFDQSx1QkFBQTtFQUNBLG1CQUFBO0VBRUEsc0JBQUE7QUFBSjtBQUNBO0VBQ0ksYUFBQTtFQUNBLHVCQUFBO0FBQ0oiLCJmaWxlIjoic3JjL2FwcC9pbnZpdGVzL2ludml0ZXMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnRlYW0tY29udGFpbmVye1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuXHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4uZmxleC1kaXJlY3Rpb24tcm93eyAgXHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbn1cclxufSJdfQ== */\";","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n      <ion-badge color=\\\"danger\\\" class=\\\"badge-notifiche\\\" *ngIf=\\\"this.env.notificationsCounter + this.env.ticketUpdates\\\">\\r\\n        {{this.env.notificationsCounter + this.env.ticketUpdates}}</ion-badge>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Inviti</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content style=\\\"--padding-top: 10px !important;\\\">\\r\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"doRefresh($event)\\\">\\r\\n    <ion-refresher-content></ion-refresher-content>\\r\\n  </ion-refresher>\\r\\n  <ion-text style=\\\"margin-left: 5px\\\">Inviti in sospeso</ion-text>\\r\\n  <ion-grid style=\\\"margin-bottom: 15px\\\">\\r\\n    <ion-text *ngIf=\\\"invitesListPending.length == 0\\\" color=\\\"danger\\\">Non hai nessun invito.\\r\\n    </ion-text>\\r\\n    <ion-row *ngFor=\\\"let invite of invitesListPending\\\">\\r\\n      <ion-col>\\r\\n        <ion-card color=\\\"white\\\" class=\\\"team-container\\\">\\r\\n          <ion-text>{{invite.teamName}}</ion-text>\\r\\n          <div class=\\\"flex-direction-row\\\">\\r\\n            <ion-button color=\\\"success\\\" (click)=\\\"changeInviteStatus(invite, 'ACCEPTED')\\\">ACCETTA</ion-button>\\r\\n            <ion-button color=\\\"danger\\\" (click)=\\\"changeInviteStatus(invite, 'DECLINED')\\\">RIFIUTA</ion-button>\\r\\n          </div>\\r\\n        </ion-card>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n\\r\\n  <ion-text style=\\\"margin-left: 5px\\\">Inviti accettati/rifiutati</ion-text>\\r\\n  <ion-grid>\\r\\n    <ion-text *ngIf=\\\"invitesListSelected.length == 0\\\" color=\\\"danger\\\">Non hai nessun invito.\\r\\n    </ion-text>\\r\\n    <ion-row *ngFor=\\\"let invite of invitesListSelected\\\">\\r\\n      <ion-col>\\r\\n        <ion-card color=\\\"white\\\" class=\\\"team-container\\\">\\r\\n          <ion-text>{{invite.teamName}}</ion-text>\\r\\n          <div class=\\\"flex-direction-row\\\">\\r\\n            <ion-text color=\\\"success\\\" *ngIf=\\\"invite.status === 'ACCEPTED'\\\">Accettato</ion-text>\\r\\n            <ion-text color=\\\"danger\\\" *ngIf=\\\"invite.status === 'DECLINED'\\\">Rifiutato</ion-text>\\r\\n          </div>\\r\\n        </ion-card>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-content>\";","import { Component, OnInit } from \"@angular/core\";\nimport { GlobalEnv } from \"../env\";\nimport { Plugins } from \"@capacitor/core\";\nconst { Storage } = Plugins;\nimport jwtDecode from \"jwt-decode\";\nimport { Router } from \"@angular/router\";\nimport { HttpClient, HttpHeaders } from \"@angular/common/http\";\nimport { AuthService } from \"src/app/services/auth.service\";\n\n@Component({\n  selector: \"app-invites\",\n  templateUrl: \"./invites.page.html\",\n  styleUrls: [\"./invites.page.scss\"],\n})\nexport class InvitesPage implements OnInit {\n  invitesListPending: any = [];\n  invitesListSelected: any = [];\n  constructor(\n    public env: GlobalEnv,\n    private router: Router,\n    private http: HttpClient,\n    private authService: AuthService\n  ) {}\n\n  async ngOnInit() {\n    const token = await Storage.get({ key: \"token\" }).then((data) => {\n      if (data.value) {\n        return data.value;\n      }\n    });\n    const decodedToken = jwtDecode(token);\n    const userId = decodedToken[\"id\"];\n    if (userId) {\n      this.getInvites(userId);\n    }\n  }\n\n  getInvites(userId) {\n    this.http.get(this.env.baseUri + `/users/${userId}`).subscribe(\n      (resp) => {\n        if (resp && resp[\"user\"].invites && resp[\"user\"].invites.length) {\n          const invitesList = resp[\"user\"].invites;\n          console.log(invitesList);\n          for (let i = 0; i < invitesList.length; i++) {\n            const tournamentId = invitesList[i].tournamentId,\n              teamId = invitesList[i].teamId;\n            this.http\n              .get(\n                this.env.baseUri +\n                  `/tournaments/${tournamentId}/teams/${teamId}`\n              )\n              .subscribe(\n                (resp) => {\n                  invitesList[i].teamName = resp[\"name\"];\n                  if (invitesList[i].status === \"PENDING\") {\n                    this.invitesListPending.push(invitesList[i]);\n                  } else {\n                    this.invitesListSelected.push(invitesList[i]);\n                  }\n                },\n                (error) => {\n                  if (invitesList[i].status === \"PENDING\") {\n                    this.invitesListPending.push(invitesList[i]);\n                  } else {\n                    this.invitesListSelected.push(invitesList[i]);\n                  }\n                }\n              );\n          }\n        }\n      },\n      (error) => {\n        // Empty\n      }\n    );\n  }\n\n  async changeInviteStatus(inviteObj, status) {\n    this.env.isLoading = true;\n    const token = await Storage.get({ key: \"token\" }).then((data) => {\n      if (data.value) {\n        return data.value;\n      }\n    });\n    this.http\n      .patch(this.env.baseUri + `/invites/${inviteObj._id}`, {\n        newStatus: status,\n      })\n      .subscribe(\n        (resp) => {\n          this.env.isLoading = false;\n          location.reload();\n        },\n        (error) => {\n          window.alert(\"errore nell'accettare l'invito.\");\n        }\n      );\n  }\n\n  doRefresh(event) {\n    this.authService.getToken().then(() => {\n      if (this.authService.isLoggedIn) {\n        Storage.get({ key: \"token\" }).then((data) => {\n          const decodedToken = jwtDecode(data.value);\n          const userId = decodedToken[\"id\"];\n          if (userId) {\n            this.getInvites(userId);\n          }\n          event.target.complete();\n        });\n      } else {\n        this.router.navigateByUrl(\"/login\");\n      }\n    });\n  }\n}\n"],"sourceRoot":"webpack:///"}